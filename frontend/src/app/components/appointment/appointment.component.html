<div class="container mx-auto px-4 py-8 max-w-3xl">
  <div class="card glass-pane border-0 p-4 p-md-5">
    <div class="text-center mb-5">
      <h1 class="h2 fw-bold text-uppercase mb-2"><i class="bi bi-calendar-event me-2 text-primary"></i> Agendar <span
          class="text-primary">Cita</span></h1>
      <p class="text-secondary">Complete el formulario para solicitar nuestros servicios expertos.</p>
    </div>

    @if (successMessage()) {
    <div
      class="alert alert-success bg-success bg-opacity-10 border-success text-success mb-4 d-flex align-items-center">
      <i class="bi bi-check-circle-fill me-2 fs-4"></i>
      {{ successMessage() }}
    </div>
    }

    @if (errorMessage()) {
    <div class="alert alert-danger bg-danger bg-opacity-10 border-danger text-danger mb-4 d-flex align-items-center">
      <i class="bi bi-exclamation-triangle-fill me-2 fs-4"></i>
      {{ errorMessage() }}
    </div>
    }

    <form (ngSubmit)="submitAppointment()" class="needs-validation">
      <!-- Información Personal -->
      <div class="mb-5">
        <h4 class="text-light border-bottom border-secondary pb-2 mb-4 d-flex align-items-center">
          <i class="bi bi-person-badge me-2 text-primary"></i> Información Personal
        </h4>
        <div class="row g-3">
          <div class="col-md-6">
            <div class="form-floating">
              <input type="text" id="customerName" [value]="appointment().customerName"
                (input)="handleInputChange($event, 'customerName')" class="form-control" placeholder="Nombre Completo"
                required>
              <label for="customerName" class="text-secondary">Nombre Completo *</label>
            </div>
          </div>
          <div class="col-md-6">
            <div class="form-floating">
              <input type="email" id="customerEmail" [value]="appointment().customerEmail"
                (input)="handleInputChange($event, 'customerEmail')" class="form-control" placeholder="Email" required>
              <label for="customerEmail" class="text-secondary">Email *</label>
            </div>
          </div>
          <div class="col-md-6">
            <div class="form-floating">
              <input type="tel" id="customerPhone" [value]="appointment().customerPhone"
                (input)="handleInputChange($event, 'customerPhone')" class="form-control" placeholder="Teléfono"
                required>
              <label for="customerPhone" class="text-secondary">Teléfono *</label>
            </div>
          </div>
          <div class="col-md-6">
            <div class="form-floating">
              <input type="datetime-local" id="appointmentDate" [value]="appointment().appointmentDate"
                (input)="handleInputChange($event, 'appointmentDate')" class="form-control" required>
              <label for="appointmentDate" class="text-secondary">Fecha y Hora Preferida *</label>
            </div>
          </div>
          <div class="col-12">
            <div class="form-floating">
              <input type="text" id="serviceAddress" [value]="appointment().serviceAddress"
                (input)="handleInputChange($event, 'serviceAddress')" class="form-control" placeholder="Dirección"
                required>
              <label for="serviceAddress" class="text-secondary">Dirección del Servicio *</label>
            </div>
          </div>
        </div>
      </div>

      <!-- Información del Vehículo -->
      <div class="mb-5">
        <h4 class="text-light border-bottom border-secondary pb-2 mb-4 d-flex align-items-center">
          <i class="bi bi-car-front-fill me-2 text-primary"></i> Información del Vehículo
        </h4>
        <div class="row g-3">
          <div class="col-md-4">
            <div class="form-floating">
              <input type="text" id="vehicleMake" [value]="appointment().vehicleMake"
                (input)="handleInputChange($event, 'vehicleMake')" class="form-control" placeholder="Marca" required>
              <label for="vehicleMake" class="text-secondary">Marca *</label>
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-floating">
              <input type="text" id="vehicleModel" [value]="appointment().vehicleModel"
                (input)="handleInputChange($event, 'vehicleModel')" class="form-control" placeholder="Modelo" required>
              <label for="vehicleModel" class="text-secondary">Modelo *</label>
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-floating">
              <input type="text" id="vehicleYear" [value]="appointment().vehicleYear"
                (input)="handleInputChange($event, 'vehicleYear')" class="form-control" placeholder="Año">
              <label for="vehicleYear" class="text-secondary">Año</label>
            </div>
          </div>
        </div>
      </div>

      <!-- Tipo de Servicio -->
      <div class="mb-5">
        <h4 class="text-light border-bottom border-secondary pb-2 mb-4 d-flex align-items-center">
          <i class="bi bi-wrench-adjustable me-2 text-primary"></i> Tipo de Servicio
        </h4>
        <div class="mb-3">
          <div class="form-floating">
            <select id="serviceType" [value]="appointment().serviceType"
              (change)="handleInputChange($event, 'serviceType')" class="form-select" required>
              @for (type of serviceTypes; track type.value) {
              <option [value]="type.value" class="text-dark">{{ type.label }}</option>
              }
            </select>
            <label for="serviceType" class="text-secondary">Servicio Requerido *</label>
          </div>
        </div>
        <div>
          <div class="form-floating">
            <textarea id="notes" [value]="appointment().notes" (input)="handleInputChange($event, 'notes')"
              class="form-control" placeholder="Notas" style="height: 100px"></textarea>
            <label for="notes" class="text-secondary">Notas Adicionales</label>
          </div>
        </div>
      </div>

      <!-- Submit Button -->
      <div class="d-flex gap-3">
        <button type="submit" [disabled]="isSubmitting()" class="btn btn-primary btn-lg flex-grow-1 fw-bold shadow-lg">
          @if(isSubmitting()) {
          <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span> Enviando...
          } @else {
          AGENDAR CITA
          }
        </button>
        <button type="button" (click)="router.navigate(['/'])" class="btn btn-outline-secondary btn-lg px-4">
          Cancelar
        </button>
      </div>
    </form>
  </div>
</div>