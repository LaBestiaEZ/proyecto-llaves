<div class="container py-5">
  <h1 class="h2 fw-bold mb-5 text-uppercase">Gestión de <span class="text-primary">FAQs</span></h1>

  @if (loading()) {
  <app-loading-spinner message="Cargando FAQs..."></app-loading-spinner>
  } @else {
  <div class="row g-5">
    <!-- Formulario -->
    <div class="col-lg-5">
      <div class="card glass-pane border-0 sticky-top" style="top: 100px;">
        <div class="card-body p-4">
          <h2 class="h5 fw-bold mb-4 text-uppercase">
            <i class="bi bi-question-circle me-2 text-primary"></i>
            {{ isEditing() ? 'Editar FAQ' : 'Nueva FAQ' }}
          </h2>
          <form (ngSubmit)="saveFaq()">
            <div class="form-floating mb-3">
              <input type="text" id="question" [value]="currentFaq().question"
                (input)="handleInputChange($event, 'question')" class="form-control" placeholder="Pregunta" required>
              <label for="question" class="text-secondary">Pregunta</label>
            </div>

            <div class="form-floating mb-3">
              <textarea id="answer" [value]="currentFaq().answer" (input)="handleInputChange($event, 'answer')"
                class="form-control" placeholder="Respuesta" style="height: 150px" required></textarea>
              <label for="answer" class="text-secondary">Respuesta</label>
            </div>

            <div class="row g-3 mb-4">
              <div class="col-6">
                <div class="form-floating">
                  <input type="number" id="position" [value]="currentFaq().position"
                    (input)="handleNumberChange($event, 'position')" class="form-control" placeholder="Posición"
                    required>
                  <label for="position" class="text-secondary">Posición</label>
                </div>
              </div>
              <div class="col-6 d-flex align-items-center">
                <div class="form-check form-switch ps-5">
                  <input type="checkbox" id="active" [checked]="currentFaq().active"
                    (change)="handleCheckboxChange($event, 'active')" class="form-check-input" role="switch">
                  <label for="active" class="form-check-label text-light">Activa</label>
                </div>
              </div>
            </div>

            <div class="d-grid gap-2 d-md-flex">
              <button type="submit" class="btn btn-primary fw-bold flex-grow-1">
                <i class="bi bi-save me-2"></i> {{ isEditing() ? 'Actualizar' : 'Crear' }}
              </button>
              @if (isEditing()) {
              <button type="button" (click)="resetForm()" class="btn btn-outline-secondary flex-grow-1">
                Cancelar
              </button>
              }
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Lista de FAQs -->
    <div class="col-lg-7">
      <div class="glass-pane p-4">
        <h2 class="h5 fw-bold mb-4 text-uppercase text-light">FAQs Existentes</h2>
        <div class="d-grid gap-3">
          @for (faq of faqs(); track faq.id) {
          <div class="card bg-dark bg-opacity-25 border-secondary border-opacity-25">
            <div class="card-body p-3">
              <div class="d-flex justify-content-between align-items-start gap-3">
                <div class="flex-grow-1">
                  <div class="d-flex gap-2 mb-2">
                    <span
                      class="badge bg-secondary bg-opacity-25 text-light border border-secondary border-opacity-50 rounded-pill">
                      Pos: {{ faq.position }}
                    </span>
                    @if (faq.active) {
                    <span
                      class="badge bg-success bg-opacity-25 text-success border border-success border-opacity-50 rounded-pill">
                      Activa
                    </span>
                    } @else {
                    <span
                      class="badge bg-danger bg-opacity-25 text-danger border border-danger border-opacity-50 rounded-pill">
                      Inactiva
                    </span>
                    }
                  </div>
                  <h3 class="h6 fw-bold text-light mb-2">{{ faq.question }}</h3>
                  <p class="text-secondary small mb-0">{{ faq.answer }}</p>
                </div>
                <div class="d-flex flex-column gap-2">
                  <button (click)="editFaq(faq)" class="btn btn-sm btn-outline-info" title="Editar">
                    <i class="bi bi-pencil"></i>
                  </button>
                  <button (click)="deleteFaq(faq.id!)" class="btn btn-sm btn-outline-danger" title="Eliminar">
                    <i class="bi bi-trash"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
          }
          @if (faqs().length === 0) {
          <div class="text-center text-secondary py-5">
            <i class="bi bi-inbox display-4 mb-3 d-block opacity-50"></i>
            <p>No hay FAQs registradas.</p>
          </div>
          }
        </div>
      </div>
    </div>
  </div>
  }

</div>